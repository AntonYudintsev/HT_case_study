step7:

provided OA implementation, after simplification and optimizations is shorter by 14 LOC (which is 17% out of 84),
arguably simpler in understanding, and doesn't require free lists.
